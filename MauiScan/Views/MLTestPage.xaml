<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiScan.Views.MLTestPage"
             Title="ML æµ‹è¯•">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <Label Text="PPT è§’ç‚¹æ£€æµ‹æµ‹è¯•"
                   FontSize="24"
                   FontAttributes="Bold"
                   HorizontalTextAlignment="Center"/>

            <Label Text="é€‰æ‹©ä¸€å¼ åŒ…å« PPT çš„ç…§ç‰‡è¿›è¡Œæµ‹è¯•"
                   FontSize="14"
                   HorizontalTextAlignment="Center"/>

            <!-- æŒ‰é’®ç»„ -->
            <HorizontalStackLayout Spacing="10" HorizontalOptions="Center" Margin="0,20,0,0">
                <Button x:Name="TakePhotoButton"
                        Text="ðŸ“· æ‹ç…§"
                        Clicked="OnTakePhotoClicked"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="White"
                        WidthRequest="150"/>

                <Button x:Name="SelectImageButton"
                        Text="ðŸ–¼ï¸ ç›¸å†Œ"
                        Clicked="OnSelectImageClicked"
                        BackgroundColor="{StaticResource Secondary}"
                        TextColor="White"
                        WidthRequest="150"/>
            </HorizontalStackLayout>

            <!-- å›¾ç‰‡æ˜¾ç¤º -->
            <Border StrokeThickness="2"
                    Stroke="{StaticResource Gray300}"
                    Margin="0,10,0,0"
                    IsVisible="{Binding HasImage}">
                <Image x:Name="TestImage"
                       HeightRequest="300"
                       Aspect="AspectFit"/>
            </Border>

            <!-- æ£€æµ‹æŒ‰é’® -->
            <Button x:Name="DetectButton"
                    Text="ðŸ” å¼€å§‹æ£€æµ‹"
                    Clicked="OnDetectClicked"
                    BackgroundColor="{StaticResource Success}"
                    TextColor="White"
                    IsEnabled="{Binding HasImage}"/>

            <!-- æ£€æµ‹ç»“æžœ -->
            <Frame BorderColor="{StaticResource Gray300}"
                   Padding="15"
                   Margin="0,10,0,0"
                   IsVisible="{Binding HasResult}">
                <VerticalStackLayout Spacing="10">
                    <Label Text="æ£€æµ‹ç»“æžœ"
                           FontSize="18"
                           FontAttributes="Bold"/>

                    <Label x:Name="InferenceTimeLabel"
                           FontSize="12"
                           TextColor="{StaticResource Gray600}"/>

                    <!-- ML åŽŸå§‹è¾“å‡º vs CV ç²¾ä¿®å¯¹æ¯” -->
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="5">
                        <Label Text="ML åŽŸå§‹è¾“å‡º (è“è‰²)" Grid.Column="0" FontSize="12" FontAttributes="Bold" TextColor="Blue"/>
                        <Label Text="CV ç²¾ä¿®åŽ (çº¢è‰²)" Grid.Column="1" FontSize="12" FontAttributes="Bold" TextColor="Red"/>

                        <Label x:Name="MLCornersLabel" Grid.Row="1" Grid.Column="0" FontSize="10" LineBreakMode="WordWrap"/>
                        <Label x:Name="RefinedCornersLabel" Grid.Row="1" Grid.Column="1" FontSize="10" LineBreakMode="WordWrap"/>

                        <Label x:Name="MLNormalizedLabel" Grid.Row="2" Grid.Column="0" FontSize="9" TextColor="Gray" LineBreakMode="WordWrap"/>
                        <Label x:Name="RefinementDiffLabel" Grid.Row="2" Grid.Column="1" FontSize="9" TextColor="Gray" LineBreakMode="WordWrap"/>
                    </Grid>

                    <!-- å¯è§†åŒ–å¯¹æ¯”å›¾ -->
                    <Label Text="è§’ç‚¹å¯è§†åŒ– (è“=ML, çº¢=ç²¾ä¿®, ç»¿=è¿žçº¿)"
                           FontSize="12"
                           FontAttributes="Bold"
                           Margin="0,10,0,0"/>

                    <Border StrokeThickness="2"
                            Stroke="{StaticResource Gray300}">
                        <Image x:Name="VisualizationImage"
                               HeightRequest="300"
                               Aspect="AspectFit"/>
                    </Border>

                    <!-- é€è§†å˜æ¢ç»“æžœ -->
                    <Label Text="é€è§†å˜æ¢ç»“æžœ"
                           FontSize="14"
                           FontAttributes="Bold"
                           Margin="0,10,0,0"/>

                    <Border StrokeThickness="2"
                            Stroke="{StaticResource Gray300}">
                        <Image x:Name="TransformedImage"
                               HeightRequest="200"
                               Aspect="AspectFit"/>
                    </Border>
                </VerticalStackLayout>
            </Frame>

            <!-- æ¨¡åž‹ä¿¡æ¯ -->
            <Frame BorderColor="{StaticResource Gray300}"
                   Padding="15"
                   Margin="0,10,0,0">
                <VerticalStackLayout Spacing="5">
                    <Label Text="æ¨¡åž‹ä¿¡æ¯"
                           FontSize="16"
                           FontAttributes="Bold"/>

                    <Label x:Name="ModelStatusLabel"
                           FontSize="12"/>

                    <Button x:Name="CopyErrorButton"
                            Text="ðŸ“‹ å¤åˆ¶é”™è¯¯æ¶ˆæ¯"
                            Clicked="OnCopyErrorClicked"
                            BackgroundColor="{StaticResource Danger}"
                            TextColor="White"
                            FontSize="12"
                            Margin="0,5,0,0"
                            IsVisible="{Binding HasError}"/>

                    <Button x:Name="LoadModelInfoButton"
                            Text="åŠ è½½æ¨¡åž‹ä¿¡æ¯"
                            Clicked="OnLoadModelInfoClicked"
                            FontSize="12"
                            Margin="0,5,0,0"/>

                    <Label x:Name="ModelInfoLabel"
                           FontSize="12"
                           TextColor="{StaticResource Gray600}"
                           IsVisible="False"/>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
